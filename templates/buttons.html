<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bier Broker</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css">
</head>
<body>
    <div class="container card shadow p-4 mx-auto my-5">
        <h1 class="mb-3 text-center">Bier Broker</h1>
        <div id="buttons" class="mb-3">
            <div class="row">
                <div class="col">
                    <div class="row alert alert-dark mx-auto">
                        <div class="col">
                            <h3 class="label label-primary">Bier 0,3l</h3>
                        </div>
                        <div class="col-6">
                            <input type="number" name="anzahl" min="0" oninput="calculateTotalPrice()">
                        </div>
                        <div class="col">
                            <span id="bier_price">1.50</span>
                            <span>€</span>
                        </div>
                    </div>
                </div>
                <div class="col col-lg-*">
                    <div class="row alert alert-dark mx-auto">
                        <div class="col">
                            <h3 class="label label-primary">Bier 0,5l</h3>
                        </div>
                        <div class="col-6">
                            <input type="number" name="anzahl" min="0" oninput="calculateTotalPrice()">
                        </div>
                        <div class="col">
                            <span id="bier_big_price">2.00</span>
                            <span>€</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <div class="row alert alert-dark mx-auto">
                        <div class="col">
                            <h3 class="label label-primary">Mische</h3>
                        </div>
                        <div class="col-6">
                            <input type="number" name="anzahl" min="0" oninput="calculateTotalPrice()">
                        </div>
                        <div class="col">
                            <span id="mische_price">3.00</span>
                            <span>€</span>
                        </div>
                    </div>
                </div>
                <div class="col col-lg-*">
                    <div class="row alert alert-dark mx-auto">
                        <div class="col">
                            <h3 class="label label-primary">Shot</h3>
                        </div>
                        <div class="col-6">
                            <input type="number" name="anzahl" min="0" oninput="calculateTotalPrice()">
                        </div>
                        <div class="col">
                            <span id="shot_price">1.00</span>
                            <span>€</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <div class="row alert alert-dark mx-auto">
                        <div class="col">
                            <h3 class="label label-primary">Cider</h3>
                        </div>
                        <div class="col-6">
                            <input type="number" name="anzahl" min="0" oninput="calculateTotalPrice()">
                        </div>
                        <div class="col">
                            <span id="cider_preis">2.00</span>
                            <span>€</span>
                        </div>
                    </div>
                </div>
                <div class="col col-lg-*">
                    <div class="row alert alert-dark mx-auto">
                        <div class="col">
                            <h3 class="label label-primary">Bachwasser</h3>
                        </div>
                        <div class="col">
                            <input type="number" name="anzahl" min="0" oninput="calculateTotalPrice()" oninput="calculateTotalPrice()">
                        </div>
                        <div class="col">
                            <span id="bachwasser_preis">2.00</span>
                            <span>€</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="mb-3 text-center ">
            <div class="row alert alert-dark mx-auto w-75">
                <div class="col">
                    <label class="h4">Gesamt Preis</label>
                </div>
                <div class="col-6">
                    <label id="price_total" class="h4"></label>
                    <span class="h4">€</span>
                </div>
                <div class="col">
                    <button class="btn btn-primary">Investieren</button>
                </div>
            </div>
        </div>
        
    </div>

    <script>
        function updatePrices() {
            // Fetch updated prices every 5 minutes
            fetch('/update_prices')  // Assumes an endpoint exists to provide updated prices
                .then(response => response.json())
                .then(data => {
                    document.getElementById('bier_price').innerText = data.bier_03;
                    document.getElementById('bier_big_price').innerText = data.bier_05;
                    document.getElementById('mische_price').innerText = data.mische;
                    document.getElementById('shot_price').innerText = data.shot;
                    document.getElementById('cider_preis').innerText = data.cider;
                    document.getElementById('bachwasser_preis').innerText = data.bachwasser;
                })
                .catch(error => console.error('Error fetching prices:', error));
        }

        setInterval(updatePrices, 5 * 60 * 1000); // Update prices every 5 minutes

        function calculateTotalPrice() {
            const bier03Price = parseFloat(document.getElementById('bier_price').innerText);
            const bier05Price = parseFloat(document.getElementById('bier_big_price').innerText);
            const mischePrice = parseFloat(document.getElementById('mische_price').innerText);
            const shotPrice = parseFloat(document.getElementById('shot_price').innerText);
            const ciderPrice = parseFloat(document.getElementById('cider_preis').innerText);
            const bachwasserPrice = parseFloat(document.getElementById('bachwasser_preis').innerText);

            const bier03Count = parseInt(document.getElementById('bier_03_input').value) || 0;
            const bier05Count = parseInt(document.getElementById('bier_05_input').value) || 0;
            const mischeCount = parseInt(document.getElementById('mische_input').value) || 0;
            const shotCount = parseInt(document.getElementById('shot_input').value) || 0;
            const ciderCount = parseInt(document.getElementById('cider_input').value) || 0;
            const bachwasserCount = parseInt(document.getElementById('bachwasser_input').value) || 0;

            const totalPrice = 
                (bier03Price * bier03Count) +
                (bier05Price * bier05Count) +
                (mischePrice * mischeCount) +
                (shotPrice * shotCount) +
                (ciderPrice * ciderCount) +
                (bachwasserPrice * bachwasserCount);

            document.getElementById('price_total').innerText = totalPrice.toFixed(2);
        }

        function invest() {
            // Collect input values
            const investmentData = {
                bier_03: parseInt(document.getElementById('bier_03_input').value) || 0,
                bier_05: parseInt(document.getElementById('bier_05_input').value) || 0,
                mische: parseInt(document.getElementById('mische_input').value) || 0,
                shot: parseInt(document.getElementById('shot_input').value) || 0,
                cider: parseInt(document.getElementById('cider_input').value) || 0,
                bachwasser: parseInt(document.getElementById('bachwasser_input').value) || 0
            };

            // Send investment data to the server (assuming there's an endpoint to handle it)
            fetch('/process_investment', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(investmentData)
            })
            .then(response => response.json())
            .then(data => {
                console.log('Investment processed:', data);
            })
            .catch(error => console.error('Error processing investment:', error));

            // Reset input fields and total price
            document.querySelectorAll('input[type="number"]').forEach(input => input.value = '');
            document.getElementById('price_total').innerText = '0';
        }
    </script>
</body>
</html>
